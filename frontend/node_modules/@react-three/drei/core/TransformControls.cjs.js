"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("@babel/runtime/helpers/extends"),t=require("@react-three/fiber"),n=require("lodash.omit"),r=require("lodash.pick"),o=require("react"),u=require("three"),a=require("three-stdlib");function l(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}function s(e){if(e&&e.__esModule)return e;var t=Object.create(null);return e&&Object.keys(e).forEach((function(n){if("default"!==n){var r=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(t,n,r.get?r:{enumerable:!0,get:function(){return e[n]}})}})),t.default=e,Object.freeze(t)}var c=l(e),i=l(n),d=l(r),f=s(o),v=s(u);const m=f.forwardRef((({children:e,domElement:n,onChange:r,onMouseDown:o,onMouseUp:u,onObjectChange:l,object:s,makeDefault:m,...h},E)=>{const b=["enabled","axis","mode","translationSnap","rotationSnap","scaleSnap","space","size","showX","showY","showZ"],{camera:g,...L}=h,p=d.default(L,b),j=i.default(L,b),O=t.useThree((e=>e.controls)),w=t.useThree((e=>e.gl)),T=t.useThree((e=>e.events)),q=t.useThree((e=>e.camera)),D=t.useThree((e=>e.invalidate)),y=t.useThree((e=>e.get)),C=t.useThree((e=>e.set)),M=g||q,x=n||T.connected||w.domElement,_=f.useMemo((()=>new a.TransformControls(M,x)),[M,x]),k=f.useRef();return f.useLayoutEffect((()=>(s?_.attach(s instanceof v.Object3D?s:s.current):k.current instanceof v.Object3D&&_.attach(k.current),()=>{_.detach()})),[s,e,_]),f.useEffect((()=>{if(O){const e=e=>O.enabled=!e.value;return _.addEventListener("dragging-changed",e),()=>_.removeEventListener("dragging-changed",e)}}),[_,O]),f.useEffect((()=>{const e=e=>{D(),r&&r(e)};return null==_||null==_.addEventListener||_.addEventListener("change",e),o&&(null==_||null==_.addEventListener||_.addEventListener("mouseDown",o)),u&&(null==_||null==_.addEventListener||_.addEventListener("mouseUp",u)),l&&(null==_||null==_.addEventListener||_.addEventListener("objectChange",l)),()=>{null==_||null==_.removeEventListener||_.removeEventListener("change",e),o&&(null==_||null==_.removeEventListener||_.removeEventListener("mouseDown",o)),u&&(null==_||null==_.removeEventListener||_.removeEventListener("mouseUp",u)),l&&(null==_||null==_.removeEventListener||_.removeEventListener("objectChange",l))}}),[r,o,u,l,_,D]),f.useEffect((()=>{if(m){const e=y().controls;return C({controls:_}),()=>C({controls:e})}}),[m,_]),_?f.createElement(f.Fragment,null,f.createElement("primitive",c.default({ref:E,object:_},p)),f.createElement("group",c.default({ref:k},j),e)):null}));exports.TransformControls=m;
